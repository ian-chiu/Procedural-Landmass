(()=>{"use strict";var e,t={477:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(754));t.default=class{constructor(e=new o.default){this.renderer=e.renderer,this._canvas=e,this._lastFrameTime=0,this.init()}run(){this.load().catch((e=>{console.log(e)})).finally((()=>{this._canvas.setEventCallback(this.handleEvent.bind(this)),this.onReady(),requestAnimationFrame(this.loop.bind(this))}))}onLoad(){return r(this,void 0,void 0,(function*(){}))}onUpdate(e){}onEvent(e){}onReady(){}init(){}load(){return r(this,void 0,void 0,(function*(){yield this.onLoad()}))}loop(e){this._canvas.needResizeOnLoop()&&this.handleEvent(new Event("resize")),0===this._lastFrameTime&&(this._lastFrameTime=e);const t=e-this._lastFrameTime;this._lastFrameTime=e,this.onUpdate(t),requestAnimationFrame(this.loop.bind(this))}handleEvent(e){this.onEvent(e)}}},754:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Canvas=void 0;const a=o(n(232));class s{constructor(e={}){let t;if(this.eventCallback=()=>{},void 0!==e.elementId){if(t=document.getElementById(e.elementId),void 0===t)throw new Error("Cannot find a canvas element named: "+e.elementId)}else t=document.createElement("canvas"),document.body.appendChild(t);e.width&&e.height?(t.width=e.width,t.height=e.height):(t.width=t.parentElement?t.parentElement.clientWidth:300,t.height=t.parentElement?t.parentElement.clientHeight:150),this.renderer=new a.WebGLRenderer({canvas:t}),t.addEventListener("mousemove",(e=>{this.eventCallback(e)})),t.addEventListener("wheel",(e=>{this.eventCallback(e)})),this.domElement=t}setEventCallback(e){this.eventCallback=e}needResizeOnLoop(){var e,t;const n=this.renderer.domElement,r=null===(e=n.parentElement)||void 0===e?void 0:e.clientWidth,i=null===(t=n.parentElement)||void 0===t?void 0:t.clientHeight,o=n.width!==r||n.height!==i;return o&&void 0!==r&&void 0!==i&&this.renderer.setSize(r,i,!1),o}get aspect(){return this.domElement.width/this.domElement.height}}t.Canvas=s,t.default=s},515:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){this._event=e}dispatch(e,t){return e===this._event.type&&(t(this._event)&&this._event.stopPropagation(),!0)}}},294:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=o(n(232)),l=a(n(477)),h=a(n(754)),d=n(379),c=a(n(515)),u=n(34),f=new h.default({elementId:"c"}),p=new l.default(f),g=p.renderer,_={fov:50,aspect:f.aspect,near:.1,far:500},m=new s.PerspectiveCamera(_.fov,_.aspect,_.near,_.far),v=new d.OrbitControls(m,f.domElement),w=new s.Scene;w.background=new s.Color(3355443);{const e=16777215,t=1,n=new s.DirectionalLight(e,t);n.position.set(0,10,0),n.target.position.set(-5,0,0),w.add(n),w.add(n.target)}{const e=11657727,t=12155424,n=.2,r=new s.HemisphereLight(e,t,n);w.add(r)}const b=new u.MapGenerator;b.generate(),w.add(b);const M=()=>{b.drawMode===u.MapGenerator.DrawMode.Terrain?(m.position.set(0,200,-300),m.lookAt(0,0,0)):(m.position.set(0,0,-7),m.lookAt(0,0,0))};M();let y=b.drawMode;p.onUpdate=e=>{y!==b.drawMode&&(M(),y=b.drawMode),v.update(),g.render(w,m)},p.onEvent=e=>{new c.default(e).dispatch("resize",(e=>(m.aspect=f.aspect,m.updateProjectionMatrix(),!0)))},p.run()},356:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.MapDisplay=void 0;const a=o(n(232)),s=n(542);t.MapDisplay=class{static generateTexture(e){const t=e[0].length,n=e.length,r=new Uint8Array(t*n*4);for(let i=0;i<n;i++)for(let n=0;n<t;n++){let o=4*(i*t+n),a=[0,0,0];if("number"==typeof e[0][0]){const t=e,r=(0,s.mapLinear)(t[i][n],0,1,0,255);a=new Array(3).fill(r)}else{const t=e;a[0]=(0,s.mapLinear)(t[i][n].r,0,1,0,255),a[1]=(0,s.mapLinear)(t[i][n].g,0,1,0,255),a[2]=(0,s.mapLinear)(t[i][n].b,0,1,0,255)}r[o]=a[0],r[o+1]=a[1],r[o+2]=a[2],r[o+3]=255}const i=new a.DataTexture(r,t,n);return i.magFilter=a.NearestFilter,i.needsUpdate=!0,i}static generateTerrainGeometry(e,t){const n=e[0].length,r=e.length,i=Math.floor(n/2),o=Math.floor(r/2);let s=0===t?1:2*t,l=(n-1)/s+1;const h=[],d=[],c=[];let u=0;for(let t=0;t<r;t+=s)for(let a=0;a<n;a+=s){const s=20*Math.pow(e[t][a],4);h.push(a-i,s,t-o),d.push(a/n,t/r),a<n-1&&t<r-1&&(c.push(u,u+l+1,u+1),c.push(u,u+l,u+l+1)),u++}const f=new a.BufferGeometry;return f.setAttribute("position",new a.BufferAttribute(new Float32Array(h),3)),f.setAttribute("uv",new a.BufferAttribute(new Float32Array(d),2)),f.setIndex(c),f.computeVertexNormals(),f}}},34:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MapGenerator=void 0;const s=o(n(232)),l=n(356),h=n(192),d=a(n(637)),c=n(232);class u{constructor(e,t){this.object=e,this.prop=t}get value(){return`#${this.object[this.prop].getHexString()}`}set value(e){this.object[this.prop].set(e)}}class f extends s.Object3D{constructor(){if(super(),this._wireframeMode=!1,this._chunkSize=241,this._levelOfDetail=0,this._parameters={seed:0,scale:100,octaves:4,persistance:.5,lacunarity:2,offset:new c.Vector2(0,0)},this._regions=[{name:"deep water",height:.25,color:new s.Color("#2255ee")},{name:"water",height:.35,color:new s.Color("#5179ee")},{name:"sand",height:.4,color:new s.Color("#fff4c6")},{name:"grass 1",height:.55,color:new s.Color("#60bb60")},{name:"grass 2",height:.7,color:new s.Color("#468a46")},{name:"rock 1",height:.8,color:new s.Color("#694f35")},{name:"rock 2",height:.9,color:new s.Color("#423324")},{name:"snow",height:1,color:new s.Color("#eaeaea")}],localStorage.getItem("regions")){const e=localStorage.getItem("regions"),t=JSON.parse(e);this._regions=t.map((e=>Object.assign(Object.assign({},e),{color:new s.Color(e.color)})))}this._drawMode=f.DrawMode.Terrain,this._gui=new d.default;const e={NoiseMap:f.DrawMode.NoiseMap,ColorMap:f.DrawMode.ColorMap,Terrain:f.DrawMode.Terrain};this._gui.add(this,"_drawMode",e).name("draw mode").onChange(this.generate.bind(this)),this._gui.add(this,"_wireframeMode").name("wireframe").onChange(this.generate.bind(this)),this._gui.add(this,"_levelOfDetail",0,6,1).name("level of detail").onChange(this.generate.bind(this));const t=this._gui.addFolder("Noise");this._regionsFolder=this._gui.addFolder("Regions"),this._regionsFolder.close(),t.add(this._parameters,"seed").onChange(this.generate.bind(this)),t.add(this._parameters,"scale",.1,300).onChange(this.generate.bind(this)),t.add(this._parameters,"octaves",0,10).onChange(this.generate.bind(this)),t.add(this._parameters,"persistance",0,1).onChange(this.generate.bind(this)),t.add(this._parameters,"lacunarity",1,10).onChange(this.generate.bind(this)),t.add(this._parameters.offset,"x").name("offset X").onChange(this.generate.bind(this)),t.add(this._parameters.offset,"y").name("offset Y").onChange(this.generate.bind(this)),this._regionsFolder.add(this,"onPushNewRegionFromGui").name("+"),this._regionsFolder.add(this,"onPopRegionFromGUI").name("-");for(let e=0;e<this._regions.length;e++)this.addRegionFolder(e);const n=new s.PlaneGeometry(4,4);this._planeMaterial=new s.MeshBasicMaterial({side:s.DoubleSide}),this._plane=new s.Mesh(n,this._planeMaterial),this._terrainMaterial=new s.MeshPhongMaterial({color:"white"}),this._terrain=new s.Mesh(void 0,this._terrainMaterial),this._wireframeMaterial=new s.LineBasicMaterial({depthTest:!1,opacity:.25,transparent:!0}),this._wireframe=new s.LineSegments(void 0,this._wireframeMaterial)}generate(){const e=h.Noise.generateNoiseMap(this._chunkSize,this._chunkSize,this._parameters),t=[];for(let n=0;n<e.length;n++){const r=[];for(let t=0;t<e[0].length;t++){const i=e[n][t];let o=new s.Color("white");for(const e of this._regions)if(e.height>i){o=e.color;break}r.push(o)}t.push(r)}const n=()=>{this.remove(this._plane),this.remove(this._terrain),this.remove(this._wireframe)};if(this._drawMode===f.DrawMode.NoiseMap){n();const t=l.MapDisplay.generateTexture(e);this._planeMaterial.map=t,this.add(this._plane)}else if(this._drawMode===f.DrawMode.ColorMap){n();const e=l.MapDisplay.generateTexture(t);this._planeMaterial.map=e,this.add(this._plane)}else if(this._drawMode===f.DrawMode.Terrain){n();const r=l.MapDisplay.generateTerrainGeometry(e,this._levelOfDetail),i=l.MapDisplay.generateTexture(t);if(this._wireframeMode){const e=new s.WireframeGeometry(r);this._wireframe.geometry=e,this.add(this._wireframe)}else this._terrain.geometry=r,this._terrainMaterial.map=i,this.add(this._terrain)}}get drawMode(){return this._drawMode}onPushNewRegionFromGui(){const e=this._regions.length;20!==e&&(this._regions.push({name:`default_${e}`,height:1,color:new s.Color("white")}),this.addRegionFolder(e),this.onChangeRegionFromGUI())}onPopRegionFromGUI(){0!==this._regions.length&&(this._regionsFolder.children.slice(-1)[0].destroy(),this._regions.pop(),this.onChangeRegionFromGUI())}onChangeRegionFromGUI(){const e=this._regions.map((e=>Object.assign(Object.assign({},e),{color:`#${e.color.getHexString()}`})));localStorage.setItem("regions",JSON.stringify(e))}addRegionFolder(e){const t=this._regions[e],n=this._regionsFolder.addFolder(`index ${e}`),r=()=>{this.generate(),this.onChangeRegionFromGUI()};n.add(t,"name").onChange(r),n.add(t,"height",0,1).onChange(r),n.addColor(new u(t,"color"),"value").name("color").onChange(r)}}t.MapGenerator=f,function(e){let t;!function(e){e[e.NoiseMap=0]="NoiseMap",e[e.ColorMap=1]="ColorMap",e[e.Terrain=2]="Terrain"}(t=e.DrawMode||(e.DrawMode={}))}(f=t.MapGenerator||(t.MapGenerator={}))},192:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Noise=void 0;const i=r(n(311)),o=n(542);t.Noise=class{static generateNoiseMap(e,t,n){const{scale:r,seed:a,octaves:s,persistance:l,lacunarity:h,offset:d}=n,c=new i.default(a),u=[],f=[];for(let e=0;e<s;e++){const t=c.noise2D(e,e),n=c.noise2D(-e,-e),r=2e5*t-1e5+d.x,i=2e5*n-1e5+d.y;f.push([r,i])}let p=-1/0,g=1/0;const _=e/2,m=t/2;for(let n=0;n<t;n++){const t=[];for(let i=0;i<e;i++){let e=1,o=1,a=0;for(let t=0;t<s;t++){const s=(i-_)/r*e+f[t][0],d=(n-m)/r*e+f[t][1];a+=(2*c.noise2D(s,d)-1)*o,e*=h,o*=l}t.push(a),p=Math.max(p,a),g=Math.min(g,a)}u.push(t)}for(let n=0;n<t;n++)for(let t=0;t<e;t++)u[n][t]=(0,o.mapLinear)(u[n][t],g,p,0,1);return u}}}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var o=n[e]={exports:{}};return t[e].call(o.exports,o,o.exports,r),o.exports}r.m=t,e=[],r.O=(t,n,i,o)=>{if(!n){var a=1/0;for(d=0;d<e.length;d++){for(var[n,i,o]=e[d],s=!0,l=0;l<n.length;l++)(!1&o||a>=o)&&Object.keys(r.O).every((e=>r.O[e](n[l])))?n.splice(l--,1):(s=!1,o<a&&(a=o));if(s){e.splice(d--,1);var h=i();void 0!==h&&(t=h)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[n,i,o]},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={826:0,34:0,519:0,936:0,197:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var i,o,[a,s,l]=n,h=0;if(a.some((t=>0!==e[t]))){for(i in s)r.o(s,i)&&(r.m[i]=s[i]);if(l)var d=l(r)}for(t&&t(n);h<a.length;h++)o=a[h],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(d)},n=self.webpackChunkts_engine=self.webpackChunkts_engine||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var i=r.O(void 0,[232,549,637,379],(()=>r(294)));i=r.O(i)})();