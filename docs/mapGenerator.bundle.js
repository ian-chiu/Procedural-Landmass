(()=>{"use strict";var e,t={356:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,i)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.MapDisplay=void 0;const a=n(r(232)),s=r(542);t.MapDisplay=class{static generateTexture(e){const t=e[0].length,r=e.length,o=new Uint8Array(t*r*4);for(let i=0;i<r;i++)for(let r=0;r<t;r++){let n=4*(i*t+r),a=[0,0,0];if("number"==typeof e[0][0]){const t=e,o=(0,s.mapLinear)(t[i][r],0,1,0,255);a=new Array(3).fill(o)}else{const t=e;a[0]=(0,s.mapLinear)(t[i][r].r,0,1,0,255),a[1]=(0,s.mapLinear)(t[i][r].g,0,1,0,255),a[2]=(0,s.mapLinear)(t[i][r].b,0,1,0,255)}o[n]=a[0],o[n+1]=a[1],o[n+2]=a[2],o[n+3]=255}const i=new a.DataTexture(o,t,r);return i.magFilter=a.NearestFilter,i.needsUpdate=!0,i}static generateTerrainGeometry(e,t){const r=e[0].length,o=e.length,i=Math.floor(r/2),n=Math.floor(o/2);let s=0===t?1:2*t,l=(r-1)/s+1;const h=[],d=[],c=[];let g=0;for(let t=0;t<o;t+=s)for(let a=0;a<r;a+=s){const s=20*Math.pow(e[t][a],4);h.push(a-i,s,t-n),d.push(a/r,t/o),a<r-1&&t<o-1&&(c.push(g,g+l+1,g+1),c.push(g,g+l,g+l+1)),g++}const u=new a.BufferGeometry;return u.setAttribute("position",new a.BufferAttribute(new Float32Array(h),3)),u.setAttribute("uv",new a.BufferAttribute(new Float32Array(d),2)),u.setIndex(c),u.computeVertexNormals(),u}}},34:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,i)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MapGenerator=void 0;const s=n(r(232)),l=r(356),h=r(192),d=a(r(637)),c=r(232);class g{constructor(e,t){this.object=e,this.prop=t}get value(){return`#${this.object[this.prop].getHexString()}`}set value(e){this.object[this.prop].set(e)}}class u extends s.Object3D{constructor(){if(super(),this._wireframeMode=!1,this._chunkSize=241,this._levelOfDetail=0,this._parameters={seed:0,scale:100,octaves:4,persistance:.5,lacunarity:2,offset:new c.Vector2(0,0)},this._regions=[{name:"deep water",height:.25,color:new s.Color("#2255ee")},{name:"water",height:.35,color:new s.Color("#5179ee")},{name:"sand",height:.4,color:new s.Color("#fff4c6")},{name:"grass 1",height:.55,color:new s.Color("#60bb60")},{name:"grass 2",height:.7,color:new s.Color("#468a46")},{name:"rock 1",height:.8,color:new s.Color("#694f35")},{name:"rock 2",height:.9,color:new s.Color("#423324")},{name:"snow",height:1,color:new s.Color("#eaeaea")}],localStorage.getItem("regions")){const e=localStorage.getItem("regions"),t=JSON.parse(e);this._regions=t.map((e=>Object.assign(Object.assign({},e),{color:new s.Color(e.color)})))}this._drawMode=u.DrawMode.Terrain,this._gui=new d.default;const e={NoiseMap:u.DrawMode.NoiseMap,ColorMap:u.DrawMode.ColorMap,Terrain:u.DrawMode.Terrain};this._gui.add(this,"_drawMode",e).name("draw mode").onChange(this.generate.bind(this)),this._gui.add(this,"_wireframeMode").name("wireframe").onChange(this.generate.bind(this)),this._gui.add(this,"_levelOfDetail",0,6,1).name("level of detail").onChange(this.generate.bind(this));const t=this._gui.addFolder("Noise");this._regionsFolder=this._gui.addFolder("Regions"),this._regionsFolder.close(),t.add(this._parameters,"seed").onChange(this.generate.bind(this)),t.add(this._parameters,"scale",.1,300).onChange(this.generate.bind(this)),t.add(this._parameters,"octaves",0,10).onChange(this.generate.bind(this)),t.add(this._parameters,"persistance",0,1).onChange(this.generate.bind(this)),t.add(this._parameters,"lacunarity",1,10).onChange(this.generate.bind(this)),t.add(this._parameters.offset,"x").name("offset X").onChange(this.generate.bind(this)),t.add(this._parameters.offset,"y").name("offset Y").onChange(this.generate.bind(this)),this._regionsFolder.add(this,"onPushNewRegionFromGui").name("+"),this._regionsFolder.add(this,"onPopRegionFromGUI").name("-");for(let e=0;e<this._regions.length;e++)this.addRegionFolder(e);const r=new s.PlaneGeometry(4,4);this._planeMaterial=new s.MeshBasicMaterial({side:s.DoubleSide}),this._plane=new s.Mesh(r,this._planeMaterial),this._terrainMaterial=new s.MeshPhongMaterial({color:"white"}),this._terrain=new s.Mesh(void 0,this._terrainMaterial),this._wireframeMaterial=new s.LineBasicMaterial({depthTest:!1,opacity:.25,transparent:!0}),this._wireframe=new s.LineSegments(void 0,this._wireframeMaterial)}generate(){const e=h.Noise.generateNoiseMap(this._chunkSize,this._chunkSize,this._parameters),t=[];for(let r=0;r<e.length;r++){const o=[];for(let t=0;t<e[0].length;t++){const i=e[r][t];let n=new s.Color("white");for(const e of this._regions)if(e.height>i){n=e.color;break}o.push(n)}t.push(o)}const r=()=>{this.remove(this._plane),this.remove(this._terrain),this.remove(this._wireframe)};if(this._drawMode===u.DrawMode.NoiseMap){r();const t=l.MapDisplay.generateTexture(e);this._planeMaterial.map=t,this.add(this._plane)}else if(this._drawMode===u.DrawMode.ColorMap){r();const e=l.MapDisplay.generateTexture(t);this._planeMaterial.map=e,this.add(this._plane)}else if(this._drawMode===u.DrawMode.Terrain){r();const o=l.MapDisplay.generateTerrainGeometry(e,this._levelOfDetail),i=l.MapDisplay.generateTexture(t);if(this._wireframeMode){const e=new s.WireframeGeometry(o);this._wireframe.geometry=e,this.add(this._wireframe)}else this._terrain.geometry=o,this._terrainMaterial.map=i,this.add(this._terrain)}}get drawMode(){return this._drawMode}onPushNewRegionFromGui(){const e=this._regions.length;20!==e&&(this._regions.push({name:`default_${e}`,height:1,color:new s.Color("white")}),this.addRegionFolder(e),this.onChangeRegionFromGUI())}onPopRegionFromGUI(){0!==this._regions.length&&(this._regionsFolder.children.slice(-1)[0].destroy(),this._regions.pop(),this.onChangeRegionFromGUI())}onChangeRegionFromGUI(){const e=this._regions.map((e=>Object.assign(Object.assign({},e),{color:`#${e.color.getHexString()}`})));localStorage.setItem("regions",JSON.stringify(e))}addRegionFolder(e){const t=this._regions[e],r=this._regionsFolder.addFolder(`index ${e}`),o=()=>{this.generate(),this.onChangeRegionFromGUI()};r.add(t,"name").onChange(o),r.add(t,"height",0,1).onChange(o),r.addColor(new g(t,"color"),"value").name("color").onChange(o)}}t.MapGenerator=u,function(e){let t;!function(e){e[e.NoiseMap=0]="NoiseMap",e[e.ColorMap=1]="ColorMap",e[e.Terrain=2]="Terrain"}(t=e.DrawMode||(e.DrawMode={}))}(u=t.MapGenerator||(t.MapGenerator={}))},192:function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Noise=void 0;const i=o(r(311)),n=r(542);t.Noise=class{static generateNoiseMap(e,t,r){const{scale:o,seed:a,octaves:s,persistance:l,lacunarity:h,offset:d}=r,c=new i.default(a),g=[],u=[];for(let e=0;e<s;e++){const t=c.noise2D(e,e),r=c.noise2D(-e,-e),o=2e5*t-1e5+d.x,i=2e5*r-1e5+d.y;u.push([o,i])}let f=-1/0,p=1/0;const _=e/2,m=t/2;for(let r=0;r<t;r++){const t=[];for(let i=0;i<e;i++){let e=1,n=1,a=0;for(let t=0;t<s;t++){const s=(i-_)/o*e+u[t][0],d=(r-m)/o*e+u[t][1];a+=(2*c.noise2D(s,d)-1)*n,e*=h,n*=l}t.push(a),f=Math.max(f,a),p=Math.min(p,a)}g.push(t)}for(let r=0;r<t;r++)for(let t=0;t<e;t++)g[r][t]=(0,n.mapLinear)(g[r][t],p,f,0,1);return g}}}},r={};function o(e){var i=r[e];if(void 0!==i)return i.exports;var n=r[e]={exports:{}};return t[e].call(n.exports,n,n.exports,o),n.exports}o.m=t,e=[],o.O=(t,r,i,n)=>{if(!r){var a=1/0;for(d=0;d<e.length;d++){for(var[r,i,n]=e[d],s=!0,l=0;l<r.length;l++)(!1&n||a>=n)&&Object.keys(o.O).every((e=>o.O[e](r[l])))?r.splice(l--,1):(s=!1,n<a&&(a=n));if(s){e.splice(d--,1);var h=i();void 0!==h&&(t=h)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[r,i,n]},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={936:0,197:0};o.O.j=t=>0===e[t];var t=(t,r)=>{var i,n,[a,s,l]=r,h=0;if(a.some((t=>0!==e[t]))){for(i in s)o.o(s,i)&&(o.m[i]=s[i]);if(l)var d=l(o)}for(t&&t(r);h<a.length;h++)n=a[h],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(d)},r=self.webpackChunkts_engine=self.webpackChunkts_engine||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var i=o.O(void 0,[232,549,637],(()=>o(34)));i=o.O(i)})();